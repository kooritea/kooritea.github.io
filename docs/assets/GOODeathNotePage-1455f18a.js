import{_ as w,B as P,L as I,A as N,a as S}from"./index-4ba0857e.js";import{P as D,f as L,h as G}from"./GreatOldOne-b84ab02c.js";import{g as O,h as A}from"./element-plus-c9c19afe.js";import{a_ as g,bf as v,aS as y,cd as r,aL as _,aM as T,bk as s,bq as u,br as C,bw as k,aN as B,bv as x,bu as V}from"./vendor-181cef01.js";import"./highlightjs-4914df6f.js";const E={components:{ButtonBox:P,LoadingIcon:I,AsyncButtom:N,PageHeader:D,ElTable:O,ElTableColumn:A},setup(){const t=g("/"),o=v({}),c=g(!1),a=v([]),{devMode:h}=S(),i=y(()=>({repo:h.value?"api-test":"kooritea.github.io",username:"kooritea",branch:"master",useConfigToken:"1"})),m=e=>{a.splice(0,a.length),a.push(...e)},p=y(()=>{const e=[...o[t.value]||[]];return!c.value&&t.value!=="/"&&t.value!==""&&e.unshift({type:"dir",name:"..",path:t.value.includes("/")?t.value.slice(0,t.value.lastIndexOf("/")):"/"}),e}),l=(e,n)=>{if(t.value=e,!o[e]||n)return o[e]=void 0,c.value=!0,L({...i.value,path:e}).then(b=>{b.type==="dir"&&(o[e]=b.children)}).finally(()=>{c.value=!1})};l("/");const d=e=>G({...i.value,files:e.map(n=>({isDel:!0,path:n.path}))}).then(()=>l(t.value,!0));return{onSelectionChange:m,repoConfig:i,tableData:p,loadPath:l,currentPath:t,handlers:[{name:"删除选中的项",type:"danger",disabled:()=>a.length===0,handler:()=>d(a)},{name:"刷新",type:"default",handler:()=>{t.value="/";for(const e in o)delete o[e];return l("/")}}],deleteItem:d}},methods:{onCellClick(t,o,c,a){o.property==="name"&&t.type==="dir"&&this.loadPath(t.path)}}},H={class:"page"};function M(t,o,c,a,h,i){const m=r("PageHeader"),p=r("LoadingIcon"),l=r("el-table-column"),d=r("AsyncButtom"),f=r("el-table"),e=r("ButtonBox");return _(),T("div",H,[s(m),s(f,{border:"",data:a.tableData,style:{width:"100%"},onCellClick:i.onCellClick,onSelectionChange:a.onSelectionChange},{empty:u(()=>[B("div",null,[s(p)])]),default:u(()=>[s(l,{type:"selection",selectable:n=>n.type==="file"},null,8,["selectable"]),s(l,{"class-name":"filename-cell","show-overflow-tooltip":"",prop:"name",label:"文件名"},{default:u(n=>[B("span",null,x(n.row.type==="dir"?"📁":"📄")+x(n.row.name),1)]),_:1}),s(l,{label:"操作",width:"120px"},{default:u(n=>[n.row.type==="file"?(_(),C(d,{key:0,type:"danger",size:"mini","on-click":()=>a.deleteItem([n.row])},{default:u(()=>[V("删除")]),_:2},1032,["on-click"])):k("",!0)]),_:1})]),_:1},8,["data","onCellClick","onSelectionChange"]),a.handlers.length>0?(_(),C(e,{key:0,handlers:a.handlers},null,8,["handlers"])):k("",!0)])}const K=w(E,[["render",M],["__scopeId","data-v-14ab4aba"]]);export{K as default};
