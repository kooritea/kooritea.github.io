import{P as B}from"./PageHeader-b5f3a320.js";import{N as x}from"./NextButton-04f97358.js";import{j as C}from"./element-plus-5d967f66.js";import{_ as k,T as N,A as I,q as M,I as V,J as A,K as P}from"./index-7b9a30c5.js";import{I as W}from"./ImageCon-4c38e14b.js";import{b8 as u,bI as w,cg as d,aR as h,aS as p,bD as i,aT as s,a_ as K,b_ as T,bw as D,bA as L,bC as c,bx as Y,bB as O}from"./vendor-a6581121.js";import"./highlightjs-4914df6f.js";const U={components:{ImageCon:W,NextButton:x,PageHeader:B,TextInput:N,ElDatePicker:C,AsyncButtom:I},setup(){const l=u(""),n=u(""),a=w([]),t=u(!0),r=u(!1),_=()=>{if(n.value)return r.value=!0,A(n.value,a.length?a.length+1:0).then(o=>{a.push(...o),t.value=o.length===24}).finally(()=>{r.value=!1})},m=()=>{if(l.value)return r.value=!0,P(l.value,a.length/24+1).then(o=>{a.push(...o),t.value=o.length===24}).finally(()=>{r.value=!1})};return{yearMonth:l,keyWord:n,onKeyWordChange:o=>{l.value="",a.splice(0,a.length),t.value=!0,_()},onMonthChange:o=>{n.value="",t.value=!0,a.splice(0,a.length),m()},listData:a,hasNext:t,switchBangumiAdded:o=>o.id?M(o.id).then(()=>{o.id=null}):(delete o.id,V(o).then(e=>{o.id=e.id})),loading:r,onNext:()=>{if(n.value)return _();if(l.value)return m()}}}},H={class:"page"},R={class:"search-box"},j={class:"bangumi-list"},E={class:"left"},G={class:"info"},S={class:"name"},q={class:"nname"},F={class:"episode-time"},J={class:"right"};function b(l,n,a,t,r,_){const m=d("PageHeader"),v=d("el-date-picker"),g=d("TextInput"),y=d("ImageCon"),f=d("AsyncButtom"),o=d("NextButton");return h(),p("div",H,[i(m),s("div",R,[i(v,{modelValue:t.yearMonth,"onUpdate:modelValue":n[0]||(n[0]=e=>t.yearMonth=e),type:"month",placeholder:"按月份搜索","value-format":"YYYY-M",onChange:t.onMonthChange},null,8,["modelValue","onChange"]),i(g,{modelValue:t.keyWord,"onUpdate:modelValue":n[1]||(n[1]=e=>t.keyWord=e),"on-input":t.onKeyWordChange},null,8,["modelValue","on-input"])]),s("div",j,[(h(!0),p(K,null,T(t.listData,e=>(h(),p("div",{key:e.subject,class:"bangumi"},[s("div",E,[i(y,{src:`https://lain.bgm.tv/pic/cover/c${e.img}`,prefix:[""],onClick:z=>l.$imagePreview(`https://lain.bgm.tv/pic/cover/l${e.img}`,{fileName:e.name||e.nname})},null,8,["src","onClick"]),s("div",G,[s("div",S,c(e.name),1),s("div",q,c(e.nname),1),s("div",F,c(e.episode?`${e.episode}集`:"")+" "+c(e.time),1)])]),s("div",J,[i(f,{type:e.id?"primary":"default",onLoadingClick:()=>t.switchBangumiAdded(e)},{default:Y(()=>[O(c(e.id?"已添加":"添加"),1)]),_:2},1032,["type","onLoadingClick"])])]))),128))]),t.keyWord||t.yearMonth?(h(),D(o,{key:0,hasNext:t.hasNext,"onUpdate:hasNext":n[2]||(n[2]=e=>t.hasNext=e),loading:t.loading,"onUpdate:loading":n[3]||(n[3]=e=>t.loading=e),onLoadingClick:t.onNext},null,8,["hasNext","loading","onLoadingClick"])):L("",!0)])}const ne=k(U,[["render",b],["__scopeId","data-v-ca5a65b7"]]);export{ne as default};
