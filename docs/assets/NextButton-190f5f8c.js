import{_ as y,L as N,j as k}from"./index-465aab7a.js";import{m as L,r as w,t as b,z as H,aN as B,o as i,h as r,ao as C,$ as E,j as _,a2 as h,X as T}from"./vendor-3b101320.js";const I={components:{LoadingIcon:N},props:{hasNext:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},onClick:{type:Function,required:!0}},setup(s,{emit:l}){const{computedHasNext:c,computedLoading:e}=k(s,l),d=L(()=>!s.hasNext||e.value),u=()=>{if(!d.value)try{e.value=!0;const t=s.onClick(e.value);t instanceof Promise?t.then(o=>{typeof(o==null?void 0:o.hasNext)=="boolean"&&(c.value=o.hasNext)}).finally(()=>{e.value=!1}):(typeof(t==null?void 0:t.hasNext)=="boolean"&&(c.value=t.hasNext),e.value=!1)}catch{e.value=!1}},n=w(30);let a=null;const m=t=>{if(d.value)return;const{scrollTop:o,clientHeight:x,scrollHeight:g}=document.documentElement;if(t>0&&Math.abs(g-(o+x))<60){if(n.value--,n.value===0){n.value=30,u();return}a&&clearTimeout(a),a=setTimeout(()=>{n.value=30},500)}},p=t=>{m(t.deltaY)};let f=null;const v=t=>{if(t.touches.length===1){const o=t.touches[0];if(!f){f=o.pageY;return}m((o.pageY-f)/5)}};return b(()=>{window.addEventListener("wheel",p),window.addEventListener("touchmove",v)}),H(()=>{window.removeEventListener("wheel",p),window.addEventListener("touchmove",v)}),{computedLoading:e,nextOffset:n,clickHandler:u,disabled:d}}},O={key:0,class:"loading"},Y={key:1},z={key:2};function V(s,l,c,e,d,u){const n=B("LoadingIcon");return i(),r("div",{class:T(["next-button",{disabled:e.disabled,loading:e.computedLoading}]),onClick:l[0]||(l[0]=(...a)=>e.clickHandler&&e.clickHandler(...a))},[e.computedLoading?(i(),r("span",O,[C(" 加载中 "),E(n)])):c.hasNext?(i(),r("span",Y,"下滑加载更多")):(i(),r("span",z,"没有更多")),_("div",{class:"next-mask",style:h({top:`${e.nextOffset}px`})},[_("span",{class:"next-mask-text",style:h({top:`-${e.nextOffset}px`})}," 下滑加载更多 ",4)],4)],2)}const P=y(I,[["render",V],["__scopeId","data-v-8ec8db8a"]]);export{P as N};
