import{o as c,e as f,aF as ce,aG as de,f as l,aH as Se,l as g,aI as Oe,u as ie,ao as He,r as y,p as F,ap as ye,az as v,K as Ke,X as _,W as S,U as h,$ as C,S as U,aJ as Ne,a1 as V,q as Ie,y as De,aA as we,_ as k,Y as B,am as R,a0 as O,a4 as Ee,V as W,aB as te,aK as ue,aL as Re,aM as me,aN as Ue,Z as oe,aO as Te,aP as Fe,aQ as We,T as je}from"./vendor-dfc99adc.js";import{E as Ye}from"./element-plus-addd02c2.js";import"./highlightjs-b0208cd2.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const Xe="modulepreload",ze=function(e,t){return e.startsWith(".")?new URL(e,t).href:e},ke={},E=function(t,n,o){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=ze(r,o),r in ke)return;ke[r]=!0;const a=r.endsWith(".css"),i=a?'[rel="stylesheet"]':"";if(!!o)for(let b=s.length-1;b>=0;b--){const L=s[b];if(L.href===r&&(!a||L.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${i}`))return;const p=document.createElement("link");if(p.rel=a?"stylesheet":Xe,a||(p.as="script",p.crossOrigin=""),p.href=r,document.head.appendChild(p),a)return new Promise((b,L)=>{p.addEventListener("load",b),p.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())};const M=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n},qe={},Je=e=>(ce("data-v-af5a2d59"),e=e(),de(),e),Qe={class:"loading-icon"},Ze=Je(()=>l("div",{class:"loading"},[l("div"),l("div")],-1)),et=[Ze];function tt(e,t){return c(),f("div",Qe,et)}const j=M(qe,[["render",tt],["__scopeId","data-v-af5a2d59"]]),ot={namespaced:!0,state:()=>({mobileMode:!1,darkMode:!1,offlineModeOnly:!1,openGreatOldOneGate:!1,temporaryPublicKey:"",routeLoading:null}),mutations:{setMode(e,t){for(const n in t)e[n]=t[n]},swtichMode(e,t){e[t]=!e[t]},setValue(e,t){for(const n in t)e[n]=t[n]}},getters:{isGreatOldOne(e,t,n){return!!n.LocalStorage.accessKey&&Date.now()<n.LocalStorage.accessExp}},actions:{}};function fe(){const e=Se();return{mobileMode:g({get:()=>e.state.AppInfo.mobileMode,set:t=>{e.commit("AppInfo/setMode",{mobileMode:t})}}),darkMode:g({get:()=>e.state.AppInfo.darkMode,set:t=>{e.commit("AppInfo/setMode",{darkMode:t})}}),offlineModeOnly:g({get:()=>e.state.AppInfo.offlineModeOnly,set:t=>{e.commit("AppInfo/setMode",{offlineModeOnly:t})}}),isGreatOldOne:g(()=>e.getters["AppInfo/isGreatOldOne"]),openGreatOldOneGate:g({get:()=>e.state.AppInfo.openGreatOldOneGate,set:t=>{e.commit("AppInfo/setMode",{openGreatOldOneGate:t})}}),temporaryPublicKey:g({get:()=>e.state.AppInfo.temporaryPublicKey,set:t=>{e.commit("AppInfo/setValue",{temporaryPublicKey:t})}}),routeLoading:g({get:()=>e.state.AppInfo.routeLoading,set:t=>{e.commit("AppInfo/setValue",{routeLoading:t})}})}}function Ce(){const{darkMode:e}=fe(),{meta:t}=Oe();return{pageTitle:g(()=>t[ie(e)?"darkTitle":"title"]??t.title??"冰茶的糖果罐"),fullscreen:g(()=>!!t.fullscreen)}}function ne(e,t){const n={},o=He(e);for(const s in o){const r=y(o[s].value);F(o[s],a=>{r.value=a}),n[`computed${s.slice(0,1).toUpperCase()}${s.slice(1)}`]=g({get:()=>r.value,set:a=>{t(`update:${s}`,a),r.value=a}})}return n}const Ae=function(e,t){let n;typeof e.confirmHandlerPromise=="function"&&(n=async(s,r,a)=>{if(s==="confirm"){r.confirmButtonLoading=!0;try{await e.confirmHandlerPromise(r),a()}catch(i){r.confirmButtonLoading=!1,e.errorHanlder?e.errorHanlder(i):console.error(i)}finally{r.confirmButtonLoading=!1}}else r.confirmButtonLoading||a()});let o=e.message;return typeof e.message=="string"&&(o=ye("div",null,e.message.split(`
`).map(s=>ye("p",null,s)))),Ye.prompt("",{beforeClose:n,showCancelButton:e.beforeClose||e.confirmHandlerPromise,confirmButtonText:"确认",cancelButtonText:"取消",closeOnClickModal:!1,closeOnPressEscape:!1,closeOnHashChange:!1,showInput:!1,...e,message:o},t).catch(s=>{if(s!=="cancel")throw s})},nt={install:(e,t)=>{e.config.globalProperties.$alert=Ae}},st=Ae;const at={components:{LoadingIcon:j},props:{type:{type:String,default:()=>"default"},disabled:{type:Boolean,default:()=>!1},loading:{type:Boolean,default:()=>!1},onClick:{type:Function,default:void 0},confirm:{type:[Object,Boolean],default:void 0},size:{type:String,default:()=>"normal"}},emits:["click","update:loading"],setup(e,{emit:t}){const{computedLoading:n}=ne(e,t);return{computedLoading:n}},methods:{_onClick(){var e;if(!(this.computedLoading||this.disabled))if(this.confirm!==void 0?this.confirm:this.type==="danger"){const t=n=>!!n;st({title:"提示",message:"确认执行操作?",type:"warning",confirmHandlerPromise:n=>this.do(n),inputValidator:(e=this.confirm)!=null&&e.showInput?t:void 0,inputErrorMessage:"请输入内容",...this.confirm??{}})}else this.do()},do(e){if(typeof this.onClick=="function"){const t=this.onClick(e);if(t instanceof Promise)return this.computedLoading=!0,t.finally(()=>{this.computedLoading=!1})}this.$emit("click")}}};function rt(e,t,n,o,s,r){const a=v("LoadingIcon");return c(),f("div",{class:S(["button",{loading:o.computedLoading,disabled:n.disabled,[n.type]:!0,[n.size]:!0}]),onClick:t[0]||(t[0]=C((...i)=>r._onClick&&r._onClick(...i),["stop"]))},[Ke(e.$slots,"default",{},void 0,!0),o.computedLoading?(c(),_(a,{key:0,class:S({black:n.type==="primary"})},null,8,["class"])):h("",!0)],2)}const Be=M(at,[["render",rt],["__scopeId","data-v-a93caa8d"]]);const it={props:{name:{type:String,required:!0}}},lt=["xlink:href"];function ct(e,t,n,o,s,r){return c(),f("svg",{class:S(["icon",n.name]),"aria-hidden":"true"},[l("use",{"xlink:href":`#${n.name}`},null,8,lt)],2)}const pe=M(it,[["render",ct],["__scopeId","data-v-e125b142"]]);function dt(e,t=0){let n,o,s;return()=>(n&&clearTimeout(n),o||(o=new Promise(r=>{s=r})),n=setTimeout(()=>{s(e()),n=null,o=null,s=null},t),o)}function Jo(e,t="yyyy-MM-dd HH:mm:ss"){const n=function(s){return`${s<10?"0":""}${s}`},o=new Date(e);if(isNaN(o.valueOf()))throw new Error(`${e} is Invalid Date`);return t.replace(/yyyy|MM|M|dd|d|HH|H|mm|m|ss|s|DD|NDD|UTC/g,s=>{switch(s){case"yyyy":return n(o.getFullYear());case"MM":return n(o.getMonth()+1);case"M":return String(o.getMonth()+1);case"mm":return n(o.getMinutes());case"m":return String(o.getMinutes());case"dd":return n(o.getDate());case"d":return String(o.getDate());case"HH":return n(o.getHours());case"H":return String(o.getHours());case"ss":return n(o.getSeconds());case"s":return String(o.getSeconds());case"DD":switch(o.getDay()){case 1:return"周一";case 2:return"周二";case 3:return"周三";case 4:return"周四";case 5:return"周五";case 6:return"周六";case 0:return"周日";default:return String(o.getDay())}case"NDD":switch(o.getDay()){case 1:return"月曜日";case 2:return"火曜日";case 3:return"水曜日";case 4:return"木曜日";case 5:return"金曜日";case 6:return"土曜日";case 0:return"日曜日";default:return""}case"UTC":return`UTC+${0-o.getTimezoneOffset()/60}`;default:return""}})}function Qo(e){if(navigator.clipboard)navigator.clipboard.writeText(e);else{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}function Ve(){let e;document.documentElement.scrollTop?e=document.documentElement:e=document.body;let t=!1;const n=()=>{t=!0};window.addEventListener("wheel",n),window.addEventListener("touchstart",n);const o=()=>{setTimeout(()=>{e.scrollTop>0&&!t?(e.scrollTop=e.scrollTop-e.scrollTop/10,o()):(window.removeEventListener("wheel",n),window.removeEventListener("touchstart",n))},1)};o()}function ut(e,...t){return typeof e=="function"?e(t):e}function mt(e,t=[],...n){const o={...e};for(const s in e)t.includes(s)||(o[s]=ut(e[s]));return o}function Zo(e,t=0){return Promise.all([e,new Promise(n=>{setTimeout(()=>{n()},t)})]).then(n=>n[0])}const ft={components:{SvgIcon:pe,LoadingIcon:j},props:{modelValue:{type:String,default:()=>""},type:{type:String,default:()=>"input"},loading:{type:Boolean,default:()=>!1},border:{type:Boolean,default:()=>!1},disabled:{type:Boolean,default:()=>!1},onChange:{type:Function,default:null},showIcon:{type:Boolean,default:()=>!0}},setup(e,{emit:t}){const{computedModelValue:n,computedDisabled:o,computedLoading:s}=ne(e,t);return F(n,dt(()=>{try{s.value=!0;const r=e.onChange(n.value);r instanceof Promise?r.finally(()=>{s.value=!1}):s.value=!1}catch{s.value=!1}},500)),{computedModelValue:n,computedDisabled:o,computedLoading:s}}},pt={class:"text-input"},ht=["type","disabled"],gt={key:0,class:"icon-box"};function _t(e,t,n,o,s,r){const a=v("LoadingIcon"),i=v("SvgIcon");return c(),f("div",pt,[U(l("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>o.computedModelValue=d),class:S(["input",{border:n.border,"show-icon":n.showIcon}]),type:n.type,disabled:o.computedDisabled},null,10,ht),[[Ne,o.computedModelValue]]),n.showIcon?(c(),f("div",gt,[o.computedLoading?(c(),_(a,{key:0})):o.computedModelValue?(c(),_(i,{key:1,name:"icon-close",onClick:t[1]||(t[1]=d=>o.computedModelValue="")})):h("",!0)])):h("",!0)])}const vt=M(ft,[["render",_t],["__scopeId","data-v-b5460384"]]);const yt={name:"AsyncSwitch",components:{LoadingIcon:j},props:{modelValue:{type:Boolean,default:()=>!1},disabled:{type:Boolean,default:()=>!1},loading:{type:Boolean,default:()=>!1},onClick:{type:Function,default:void 0}},emits:["update:modelValue","update:loading"],setup(e,{emit:t}){const{computedLoading:n}=ne(e,t);return{computedLoading:n}},methods:{_onClick(){if(!(this.computedLoading||this.disabled))if(typeof this.onClick=="function"){const e=!this.modelValue,t=this.onClick(e);t instanceof Promise?(this.computedLoading=!0,t.then(()=>{this.$emit("update:modelValue",e)}).catch(n=>{n!==!1&&console.error(n)}).finally(()=>{this.computedLoading=!1})):this.$emit("update:modelValue",!this.modelValue)}else this.$emit("update:modelValue",!this.modelValue)}}},wt={class:"bg"};function kt(e,t,n,o,s,r){const a=v("LoadingIcon");return c(),f("div",{class:S(["switch-button",{disabled:n.disabled,loading:o.computedLoading}]),onClick:t[0]||(t[0]=C((...i)=>r._onClick&&r._onClick(...i),["stop"]))},[l("div",wt,[l("div",{class:"shadow",style:V({width:n.modelValue?"100%":"0"})},null,4)]),l("div",{class:"button",style:V({left:n.modelValue?30+"px":0})},[o.computedLoading?(c(),_(a,{key:0})):h("",!0)],4)],2)}const bt=M(yt,[["render",kt],["__scopeId","data-v-e0652b91"]]),Lt={mounted(e,t,n,o){const s=document.createElement("div");s.classList.add("mask"),t.value&&s.classList.add("show"),e.parentNode.insertBefore(s,e),e.maskDom=s,s.addEventListener("click",()=>{e.dispatchEvent(new Event("mask-click"))})},beforeUpdate(e,t,n,o){e.maskDom&&(t.value?e.maskDom.classList.add("show"):e.maskDom.classList.remove("show"))},beforeUnmount(e,t,n,o){e.maskDom&&e.maskDom.remove()}},le={handler(e,t,n,o){if(t.value){if(e.classList.add("fade-enter"),e.fadeEnterSrc===e.src)return;e.fadeEnterSrc=e.src,t.arg?(e.delayTimer&&clearTimeout(e.delayTimer),e.delayTimer=setTimeout(()=>{e.delayTimer=null,e.complete&&e.classList.remove("important-display-none")},t.arg),e.classList.add("important-display-none")):e.complete||e.classList.add("important-display-none"),e.imgFadeEnterListener=()=>{(e.delayTimer===null||!t.arg)&&e.classList.remove("important-display-none")},e.addEventListener("load",e.imgFadeEnterListener)}else e.imgFadeEnterListener&&e.removeEventListener("load",e.imgFadeEnterListener)},beforeMount(e,t,n,o){le.handler(e,t,n,o)},updated(e,t,n,o){le.handler(e,t,n,o)},unmounted(e,t,n,o){e.imgFadeEnterListener&&e.removeEventListener("load",e.imgFadeEnterListener)}};function Mt(e,t){if(!e)return"";try{const n=new TextEncoder,o=n.encode(t),s=n.encode(e),r=o.length<2?2:o.length;for(let a=0;a<s.length;a++){const i=o.length>0?o[a%o.length]:0;s[a]+=a%r+i}return s.toString()}catch{return""}}function xt(e,t){if(!e)return"";try{const n=new TextDecoder,s=new TextEncoder().encode(t),r=e.split(","),a=new Uint8Array(r),i=s.length<2?2:s.length;for(let d=0;d<a.length;d++){const p=s.length>0?s[d%s.length]:0;a[d]-=d%i+p}return n.decode(a)}catch{return""}}function Z(e){if(!e)return"";try{const t=new TextDecoder,n=e.split("x"),o=new Uint8Array(n);return t.decode(o)}catch{return""}}const Pe=4,St={namespaced:!0,state:()=>Ot(),mutations:{setItem(e,t){for(const n in t)e[n]=t[n];It(e)}},actions:{}};function be(){return{version:Pe,isExpiredGreatOldOne:!1,darkModeDecodeKey:"",devMode:!1,offlineMode:!1,accessKey:"",accessExp:0,usernameCache:"",emoteHistory:[]}}function Ot(){try{const e=JSON.parse(xt(localStorage.getItem("storage")||"","localstorage"))||{};return e.version!==Pe?be():e}catch(e){return console.error(e),be()}}function It(e){localStorage.setItem("storage",Mt(JSON.stringify(e),"localstorage"))}function Ge(){const e=Se();return{isExpiredGreatOldOne:g({get:()=>e.state.LocalStorage.isExpiredGreatOldOne,set:t=>{e.commit("LocalStorage/setItem",{isExpiredGreatOldOne:t})}}),darkModeDecodeKey:g({get:()=>e.state.LocalStorage.darkModeDecodeKey,set:t=>{e.commit("LocalStorage/setItem",{darkModeDecodeKey:t})}}),offlineMode:g({get:()=>e.state.LocalStorage.offlineMode,set:t=>{e.commit("LocalStorage/setItem",{offlineMode:t})}}),devMode:g({get:()=>e.state.LocalStorage.devMode,set:t=>{e.commit("LocalStorage/setItem",{devMode:t})}}),accessKey:g({get:()=>e.state.LocalStorage.accessKey,set:t=>{e.commit("LocalStorage/setItem",{accessKey:t})}}),accessExp:g({get:()=>e.state.LocalStorage.accessExp,set:t=>{e.commit("LocalStorage/setItem",{accessExp:t})}}),usernameCache:g({get:()=>e.state.LocalStorage.usernameCache,set:t=>{e.commit("LocalStorage/setItem",{usernameCache:t})}}),emoteHistory:g({get:()=>e.state.LocalStorage.emoteHistory,set:t=>{console.log(t),e.commit("LocalStorage/setItem",{emoteHistory:t})}})}}const Dt="https://kooritea.moe/assets/kurenai.jpg";const Et={name:"GlobalNav",components:{SvgIcon:pe,AsyncSwitch:bt,LoadingIcon:j,TextInput:vt,AsyncButtom:Be},directives:{mask:Lt,imgFadeEnter:le},setup(){const{routeLoading:e,darkMode:t,mobileMode:n,offlineModeOnly:o,openGreatOldOneGate:s}=fe(),{isExpiredGreatOldOne:r,offlineMode:a,devMode:i,darkModeDecodeKey:d}=Ge(),{pageTitle:p,fullscreen:b}=Ce(),L=y(""),A=y(!0),u=()=>{const z=document.documentElement.scrollTop||document.body.scrollTop,re=Math.min(10,z/10);L.value=`${ie(t)?"#ddd":"#222"} 0 0 ${re}px`,A.value=z>50&&!!ie(p)};Ie(()=>{window.addEventListener("scroll",u),u()}),De(()=>{window.removeEventListener("scroll",u)});let m=null,x=0;const se=()=>{x++,x>10&&(s.value=!0),m&&clearTimeout(m),m=setTimeout(()=>{x=0,m=null},1e3)},Y=y(!1),$=Oe();F(()=>$.fullPath,()=>{Y.value=!1});const ae=y(!1);let X=null;return{mobileMode:n,offlineModeOnly:o,isExpiredGreatOldOne:r,offlineMode:a,devMode:i,tryOpenGreatOldOneGate:se,openGreatOldOneGate:s,navShadow:L,showPageTitle:A,pageTitle:p,openMenu:Y,routeLoading:e,darkMode:t,darkModeDecodeKey:d,setDarkModeDecodeKeyDialog:ae,closeSetDarkModeDecodeKeyDialog:()=>{ae.value=!1,typeof X=="function"&&(X(),X=null)},onSwitchDarkMode:z=>{if(z&&!d.value)return ae.value=!0,new Promise(re=>{X=re})},fullscreen:b,setScorllGotoTop:Ve}}},G=e=>(ce("data-v-0548c824"),e=e(),de(),e),Tt={key:0,class:"mobile-menu-title"},Ct={class:"route-box"},At=G(()=>l("span",{class:"text"},"随笔",-1)),Bt=G(()=>l("span",{class:"text"},"番剧",-1)),Vt=G(()=>l("span",{class:"text"},"后台",-1)),Pt={class:"text"},Gt={class:"switch-box"},$t=G(()=>l("span",{class:"text"},"深色模式",-1)),Ht=G(()=>l("span",{class:"text"},"离线模式",-1)),Kt={key:0},Nt=G(()=>l("span",{class:"text"},"开发模式",-1)),Rt={key:1,class:"dark-entry"},Ut={class:"image",src:Dt},Ft={class:"text"},Wt=G(()=>l("span",{class:"kurenai"},"如月红",-1)),jt={class:"button-box"};function Yt(e,t,n,o,s,r){const a=v("router-link"),i=v("SvgIcon"),d=v("LoadingIcon"),p=v("AsyncSwitch"),b=v("TextInput"),L=v("AsyncButtom"),A=we("mask"),u=we("imgFadeEnter");return c(),f("nav",{class:S({fullscreen:o.fullscreen}),style:V({boxShadow:o.navShadow,fullscreen:o.fullscreen})},[l("div",{class:"logo",style:V({top:o.showPageTitle&&!o.fullscreen?"-100%":"0%"})},[l("div",{class:"slogan",onClick:t[0]||(t[0]=(...m)=>o.tryOpenGreatOldOneGate&&o.tryOpenGreatOldOneGate(...m))},[k(a,{to:"/home"},{default:B(()=>[R(" 冰茶的糖果罐 "),l("span",null,O(o.darkMode?"Unhappy Sugar Life":"Happy Sugar Life"),1)]),_:1})]),l("div",{class:"page-title",onClick:t[1]||(t[1]=m=>o.setScorllGotoTop())},O(o.pageTitle),1)],4),o.mobileMode?(c(),f("div",{key:0,class:"menu-icon",onClick:t[2]||(t[2]=m=>o.openMenu=!0)},[k(i,{name:"icon-menu"})])):h("",!0),U((c(),f("div",{class:S(["menu",{show:o.openMenu&&o.mobileMode}]),onMaskClick:t[7]||(t[7]=m=>o.openMenu=!1)},[o.mobileMode?(c(),f("div",Tt,"异国迷宫的十字路口")):h("",!0),l("ul",Ct,[k(a,{to:"/chaos"},{default:B(()=>[l("li",null,[At,o.routeLoading==="/chaos"?(c(),_(d,{key:0})):h("",!0)])]),_:1}),k(a,{to:"/pastel-memories"},{default:B(()=>[l("li",null,[Bt,o.routeLoading==="/pastel-memories"?(c(),_(d,{key:0})):h("",!0)])]),_:1}),o.isExpiredGreatOldOne||o.openGreatOldOneGate?(c(),_(a,{key:0,to:"/great-old-one"},{default:B(()=>[l("li",null,[Vt,["/great-old-one/index","/contract"].includes(o.routeLoading)?(c(),_(d,{key:0})):h("",!0)])]),_:1})):h("",!0),o.darkMode?(c(),f("li",{key:1,onClick:t[3]||(t[3]=m=>o.setDarkModeDecodeKeyDialog=!0)},[l("span",Pt,O(o.darkModeDecodeKey?"重置":"设置")+"深色模式媒介 ",1)])):h("",!0)]),l("ul",Gt,[l("li",null,[$t,k(p,{modelValue:o.darkMode,"onUpdate:modelValue":t[4]||(t[4]=m=>o.darkMode=m),"on-click":o.onSwitchDarkMode},null,8,["modelValue","on-click"])]),l("li",null,[Ht,o.offlineModeOnly?(c(),_(p,{key:0,"model-value":!0,disabled:!0})):(c(),_(p,{key:1,modelValue:o.offlineMode,"onUpdate:modelValue":t[5]||(t[5]=m=>o.offlineMode=m),disabled:o.offlineModeOnly},null,8,["modelValue","disabled"]))]),o.isExpiredGreatOldOne||o.openGreatOldOneGate?(c(),f("li",Kt,[Nt,k(p,{modelValue:o.devMode,"onUpdate:modelValue":t[6]||(t[6]=m=>o.devMode=m)},null,8,["modelValue"])])):h("",!0)])],34)),[[A,o.openMenu&&o.mobileMode]]),o.setDarkModeDecodeKeyDialog?U((c(),f("div",Rt,[U(l("img",Ut,null,512),[[u]]),l("div",Ft,[Wt,R("身上如同 "),k(b,{modelValue:o.darkModeDecodeKey,"onUpdate:modelValue":t[8]||(t[8]=m=>o.darkModeDecodeKey=m),"show-icon":!1},null,8,["modelValue"]),R(" 的诅咒试图理解人心? ")]),l("div",jt,[k(L,{type:o.darkModeDecodeKey?"primary":"info",onClick:o.closeSetDarkModeDecodeKeyDialog},{default:B(()=>[R(O(o.darkModeDecodeKey?"确认":"忽略"),1)]),_:1},8,["type","onClick"])])])),[[A,!0]]):h("",!0)],6)}const Xt=M(Et,[["render",Yt],["__scopeId","data-v-0548c824"]]);const zt={components:{SvgIcon:pe},setup(){return{messageList:Ee([])}},methods:{open({msg:e,type:t,duration:n=3e3}){const o={msg:e,type:t,cancel:!1,active:!0,key:String(Date.now())};n&&setTimeout(()=>{o.cancel=!0,this.$forceUpdate(),setTimeout(()=>{this.messageList.splice(this.messageList.indexOf(o),1)},200)},n),setTimeout(()=>{o.active=!1,this.$forceUpdate()},200),this.messageList.push(o)}}},qt={class:"msg-box"},Jt={class:"msg"};function Qt(e,t,n,o,s,r){const a=v("SvgIcon");return c(),f("div",qt,[l("ul",null,[(c(!0),f(W,null,te(o.messageList,i=>(c(),f("li",{key:i.key,class:S({[i.type]:!0,cancel:i.cancel,active:i.active})},[k(a,{name:"icon-info-circle"}),l("div",Jt,O(i.msg),1)],2))),128))])])}const Zt=M(zt,[["render",Qt],["__scopeId","data-v-72b2c5ee"]]);let q=null;const D=e=>(q||(q=ue(Zt).mount("#msg-box")),q.open(e),q);D.success=function(e,t){D({msg:e,type:"success",...t})};D.error=function(e,t){D({msg:e,type:"error",...t})};D.info=function(e,t){D({msg:e,type:"info",...t})};D.warning=function(e,t){D({msg:e,type:"warning",...t})};const eo={install:(e,t)=>{e.config.globalProperties.$msgBox=D}},I=D,w=Re({strict:!1,modules:{AppInfo:ot,LocalStorage:St}}),he=me.create({baseURL:"https://cdn.jsdelivr.net/gh/kooritea/kooritea.github.io/database"});he.interceptors.request.use(e=>(e.apiMode="offline",e.params={...e.params,ts:Date.now()},e),e=>(console.log(e),Promise.reject(e)));he.interceptors.response.use(e=>e.data,e=>{I.error(e.message),console.error(e);const t=e.config.url.indexOf("?")>-1?e.config.url.slice(0,e.config.url.indexOf("?")):e.config.url;throw delete ee[t],e});const ee={},Le=function(e){const t=e.url.indexOf("?")>-1?e.url.slice(0,e.url.indexOf("?")):e.url;return ee[t]||(ee[t]=he(e)),ee[t].then(n=>JSON.parse(JSON.stringify(n)))},H=me.create();H.interceptors.request.use(e=>{const{devMode:t,accessKey:n}=w.state.LocalStorage;if(e.apiMode=t?"dev":"online",e.baseURL=t?"http://127.0.0.1:7004":"https://api.kooritea.moe:17216",e.headers||(e.headers={}),n&&(e.headers["mass-controler-fingerprint"]=n),e.data&&typeof e.data=="object")switch(e.requestType){case"urlencode":{e.data=Object.keys(e.data).map(o=>`${encodeURIComponent(o)}=${encodeURIComponent(e.data[o])}`).join("&");break}case"formdata":{if(e.data instanceof FormData)break;const o=new FormData;for(const s in e.data)if(Array.isArray(e.data[s]))for(const r of e.data[s])o.append(s,r);else typeof e.data[s]=="object"&&!(e.data[s]instanceof File)?o.append(s,JSON.stringify(e.data[s])):o.append(s,e.data[s]);e.data=o;break}}for(const o in e.params)String(e.params[o])||delete e.params[o];return e.headers["Local-Timestamp"]=Date.now()-new Date().getTimezoneOffset()*60*1e3,e},e=>(console.log(e),Promise.reject(e)));H.interceptors.response.use(e=>{const t=e.data,{code:n,data:o,errorMsg:s}=t;if(n===4032){const r=new Error(`需要刷新页面: ${s}`);throw r.code=4032,r}if(n!==0){const r=s||"业务出错",a=new Error(r);throw a.response=e,e.config.errMsg!==!1&&I.error(s),a}return o},e=>{throw e.config.errMsg!==!1&&I.error(e.message),console.error(e),e});const P={dev:null,online:null};function Me(e){return e&&!P.dev&&(P.dev=H({apiMode:"dev",url:"/user/knock",method:"post",errMsg:!1,data:{referrer:document.referrer}}).then(t=>{w.commit("AppInfo/setValue",{temporaryPublicKey:t.publicKey})}).catch(t=>{throw I.warning("无法访问在线服务器，正在使用离线模式"),t})),!e&&!P.online&&(P.online=H({apiMode:"online",url:"/user/knock",method:"post",errMsg:!1,data:{referrer:document.referrer}}).then(t=>{w.commit("AppInfo/setValue",{temporaryPublicKey:t.publicKey})}).catch(t=>{throw I.warning("无法访问在线服务器，正在使用离线模式"),t})),P[e?"dev":"online"]}async function K(){const{offlineMode:e,devMode:t}=w.state.LocalStorage;return e?{onlineMode:!1,request:Le}:Me(t).then(()=>({onlineMode:!0,request:n=>H(n).catch(o=>{if(o.code===4032)return P.dev=null,P.online=null,Me(t).then(()=>H(n));throw o})})).catch(n=>(w.commit("AppInfo/setMode",{offlineModeOnly:!0}),{onlineMode:!1,request:Le}))}const ge=me.create();ge.interceptors.request.use(e=>{if(e.data&&typeof e.data=="object")switch(e.requestType){case"urlencode":{e.data=Object.keys(e.data).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e.data[t])}`).join("&");break}case"formdata":{if(e.data instanceof FormData)break;const t=new FormData;for(const n in e.data)if(Array.isArray(e.data[n]))for(const o of e.data[n])t.append(n,o);else typeof e.data[n]=="object"&&!(e.data[n]instanceof File)?t.append(n,JSON.stringify(e.data[n])):t.append(n,e.data[n]);e.data=t;break}}for(const t in e.params)String(e.params[t])||delete e.params[t];return e},e=>(console.log(e),Promise.reject(e)));ge.interceptors.response.use(e=>e.data,e=>{throw I.error(e.message),console.error(e),e});function en(e){return K().then(({onlineMode:t,request:n})=>t?n({url:"/blog/hitokoto/random",params:{exclude:e.join(",")}}):n({url:"/blog/hitokoto/data"}).then(o=>{const s=o.filter(r=>o.length===1||e.length===o.length||!e.includes(r.id));return s[Math.floor(Math.random()*s.length)]}))}function to(){return K().then(({onlineMode:e,request:t})=>t(e?{url:"/blog/link"}:{url:"/blog/link/data"}))}function tn({start:e,keyword:t}={}){return K().then(({onlineMode:n,request:o})=>{if(n)return/^#\d+$/.test(t)?o({url:`/blog/essay/${t.slice(1)}`}).then(s=>[s]):o({url:"/blog/essay",params:{start:e,keyword:t}});if(t){if(!/^#\d+$/.test(t))throw new Error("离线模式下仅可以使用[#id]形式检索");return o({url:`/blog/essay/${t.slice(1)}`}).then(s=>(s.content=Z(s.content),[s]))}else return o({url:"/blog/essay/index"}).then(s=>{const r=s.reverse();if(e){const a=r.indexOf(Number(e));return Promise.all(r.slice(a,a+10).map(i=>o({url:`/blog/essay/${i}`}).then(d=>(d.content=Z(d.content),d))))}else return Promise.all(r.slice(0,10).map(a=>o({url:`/blog/essay/${a}`}).then(i=>(i.content=Z(i.content),i))))})})}function on({id:e}={}){return K().then(({onlineMode:t,request:n})=>t?n({url:`/blog/essay/${e}`}):n({url:`/blog/essay/${e}`}).then(o=>(o.content=Z(o.content),o)))}function nn(){return K().then(({onlineMode:e,request:t})=>t(e?{url:"/blog/bangumi"}:{url:"/blog/bangumi/data"}))}function sn(e){return K().then(({onlineMode:t,request:n})=>(t?n:ge)({url:t?"/api/netease-cloud-music/public/song/detail":"https://netease-cloud-music-api-ashen-pi-45.vercel.app/song/detail",params:{ids:e,realIP:"116.25.146.177"}}).then(s=>{const r=t?s:s==null?void 0:s.songs;if(r.length>0)return{picUrl:r[0].al.picUrl,name:r[0].name,singer:r[0].ar.map(a=>a.name).join("/"),id:e};throw new Error(`没有找到对应的音乐: ${e}`)}))}const oo=[{name:"人理存续保障机构 菲尼斯·迦勒底",href:"https://www.fate-go.jp",title:"非的干不过欧的"},{name:"白もち桜应援团",href:"https://twitter.com/sakura_siromoti",title:""},{name:"BiLiBiLi( ゜ -゜)つロ 乾杯~",href:"https://www.bilibili.com",title:""},{name:"地球脱出计划",href:"https://kooritea.moe/site-archives/eden/index.html",title:"死にゆく楽園へ、最後のラブストーリー。"},{name:"情低保护协会",href:"",title:"その目だれの目"},{name:"圣芙蕾雅学园",href:"https://www.benghuai.com/",title:"德丽莎世界第一可爱!"},{name:"星之海学园",href:"https://charlotte-anime.jp",title:`即使失去了重要之物，少年仍然直面命运。
即使忘记了重要之人，怪物仍然挑战命运。`},{name:"ミラシュカ王国",href:"https://music.163.com/#/album?id=82096",title:"心も、病気になる"},{name:"传颂星星之人",href:"https://key.visualarts.gr.jp/product/planetarian/hd_edition/",title:"プラネタリウムはいかがですか？決して消えることの無い、無窮のきらめき。"},{name:"美食殿堂",href:"https://game.bilibili.com/pcr/",title:"お腹ぺこぺこ"}],no="Build:20230321-2(3bbf1c04)",so="https://kooritea.moe/assets/nanami.png",ao="https://kooritea.moe/assets/nanami-hurueru.png";const ro={name:"GlobalFooter",setup(){const e=y([]);to().then(n=>{const o=n.filter(a=>a.isShow),s=n.filter(a=>!a.isShow),r=[];for(;o.length>0;)r.push(o.splice(Math.random()*o.length,1)[0]);for(;s.length>0;)r.push(s.splice(Math.random()*s.length,1)[0]);e.value=r});const t=y(new Date().getFullYear());return{setScorllGotoTop:Ve,links:e,year:t,tags:oo,BuildVersion:no}}},_e=e=>(ce("data-v-f6ee3ecc"),e=e(),de(),e),io={class:"container"},lo={class:"tag-link-container"},co={class:"tag-link"},uo={class:"tags"},mo=["title"],fo=["href"],po={class:"links"},ho=_e(()=>l("div",{class:"links-title"},"友链",-1)),go=["title"],_o=["href"],vo=_e(()=>l("img",{class:"karada",src:so},null,-1)),yo=_e(()=>l("img",{class:"hurueru",src:ao},null,-1)),wo=[vo,yo],ko={class:"statement"},bo={class:"item",title:"如月"},Lo=Ue('<div class="item" title="email" data-v-f6ee3ecc><a target="_blank" href="mailto:admin@kooritea.moe" data-v-f6ee3ecc> admin@kooritea.moe </a></div><div class="item" title="Front end" data-v-f6ee3ecc><a target="_blank" href="https://github.com/vuejs/" data-v-f6ee3ecc> Page Powered by Vue 3 </a></div><div class="item" title="Back end" data-v-f6ee3ecc> Server Powered by Nginx &amp; Nest.js </div><div class="item" title="Static Resources" data-v-f6ee3ecc><a target="_blank" href="https://github.com/" data-v-f6ee3ecc> Storage Powered by Github Page </a></div><div class="item" title="CDN" data-v-f6ee3ecc><a target="_blank" href="https://www.jsdelivr.com/" data-v-f6ee3ecc> CDN Powered by jsDelivr </a></div><div class="item" title="萌备" data-v-f6ee3ecc><a target="_blank" href="https://icp.gov.moe" data-v-f6ee3ecc><img style="width:18px;height:18px;top:3px;position:relative;" src="https://icp.gov.moe/images/ico64.png" data-v-f6ee3ecc> 萌ICP备 </a><a href="https://icp.gov.moe/?keyword=20207216" target="_blank" data-v-f6ee3ecc> 20207216号 </a></div><div class="item" title="备案" data-v-f6ee3ecc>互联网安备：2333333333号</div><div class="item" title="" data-v-f6ee3ecc><a target="_blank" href="https://automattic.com/cookies/" data-v-f6ee3ecc> 本站不使用Cookie，Cookie政策爬 </a></div>',8),Mo={class:"item",title:"Build Version"};function xo(e,t,n,o,s,r){return c(),f("footer",null,[l("div",io,[l("div",lo,[l("div",co,[l("div",uo,[(c(!0),f(W,null,te(o.tags,a=>(c(),f("div",{key:a.name,class:"tag",title:a.title?a.title:a.href},[l("a",{target:"_blank",href:a.href,style:V({cursor:a.href?"pointer":"default",pointerEvents:a.href?"unset":"none"})},O(a.name),13,fo)],8,mo))),128))]),l("div",po,[ho,(c(!0),f(W,null,te(o.links,a=>(c(),f("div",{key:a.name,class:S(["link",{offline:!a.isShow}]),title:`${a.isShow?"":"[已失联]"}${a.abstract?a.abstract:a.url}`},[l("a",{target:"_blank",href:a.url,style:V({cursor:a.url?"pointer":"default",pointerEvents:a.url?"unset":"none"})},O(a.name),13,_o)],10,go))),128))])]),l("div",{class:"nanami",onClick:t[0]||(t[0]=a=>o.setScorllGotoTop())},wo)]),l("div",ko,[l("div",bo,O(`© 2016-${o.year} kisaragi`),1),Lo,l("div",Mo,O(o.BuildVersion),1)])])])}const So=M(ro,[["render",xo],["__scopeId","data-v-f6ee3ecc"]]);const Oo={name:"GlobalLayout",components:{GlobalNav:Xt,GlobalFooter:So},setup(){const{fullscreen:e}=Ce();return{fullscreen:e}}};function Io(e,t,n,o,s,r){const a=v("GlobalNav"),i=v("router-view"),d=v("GlobalFooter");return c(),f(W,null,[k(a),l("div",{class:S(["route-body",{fullscreen:o.fullscreen}])},[k(i,null,{default:B(({Component:p})=>[e.$route.meta.keepAlive?(c(),_(Te,{key:0},[(c(),_(oe(p)))],1024)):h("",!0),e.$route.meta.keepAlive?h("",!0):(c(),_(oe(p),{key:1}))]),_:1})],2),k(d)],64)}const xe=M(Oo,[["render",Io],["__scopeId","data-v-afeb444b"]]);function Do(e,t){const{openGreatOldOneGate:n}=w.state.AppInfo,o=w.getters["AppInfo/isGreatOldOne"],{isExpiredGreatOldOne:s}=w.state.LocalStorage;if(!n&&!o&&!s)return{path:"/"};if(o)return{path:"/great-old-one"}}function Eo(e,t){if(!w.getters["AppInfo/isGreatOldOne"])return{path:"/contract",query:{redirect:e.fullPath}}}function T(e){return e.catch(t=>{throw I.error(`动态加载组件失败, ${t}`),w.commit("AppInfo/setValue",{routeLoading:null}),t})}const To=[{path:"/",component:xe,redirect:"/chaos",children:[{path:"/home",component:()=>T(E(()=>import("./HomePage-8dc2ec54.js"),["https://kooritea.moe/assets/HomePage-8dc2ec54.js","https://kooritea.moe/assets/ImageCon-da2e8f46.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/ImageCon-7200ecbe.css","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/HomePage-f6e8b073.css"],import.meta.url)),meta:{title:"冰茶的糖果罐",fullscreen:!0}},{path:"/chaos",component:()=>T(E(()=>import("./ChaosPage-7a52d406.js"),["https://kooritea.moe/assets/ChaosPage-7a52d406.js","https://kooritea.moe/assets/PageHeader-6f1231f6.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/PageHeader-a8df6e84.css","https://kooritea.moe/assets/MarkDown-f9475c2b.js","https://kooritea.moe/assets/ImageCon-da2e8f46.js","https://kooritea.moe/assets/ImageCon-7200ecbe.css","https://kooritea.moe/assets/MarkDown-3376e058.css","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/GreatOldOne-43906895.js","https://kooritea.moe/assets/ChaosPage-5c789915.css"],import.meta.url)),meta:{title:"试图画出时间的影子",darkTitle:"稍微窥探头脑中的混沌",keepAlive:!0}},{path:"/pastel-memories",component:()=>T(E(()=>import("./BangumiPage-e0f4d885.js"),["https://kooritea.moe/assets/BangumiPage-e0f4d885.js","https://kooritea.moe/assets/PageHeader-6f1231f6.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/PageHeader-a8df6e84.css","https://kooritea.moe/assets/ImageCon-da2e8f46.js","https://kooritea.moe/assets/ImageCon-7200ecbe.css","https://kooritea.moe/assets/GreatOldOne-43906895.js","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/BangumiPage-3508d1df.css"],import.meta.url)),meta:{title:"番剧列表",darkTitle:"粉色回忆",keepAlive:!0}},{path:"/contract",component:()=>T(E(()=>import("./ContractPage-fca2503e.js"),["https://kooritea.moe/assets/ContractPage-fca2503e.js","https://kooritea.moe/assets/PageHeader-6f1231f6.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/PageHeader-a8df6e84.css","https://kooritea.moe/assets/GreatOldOne-43906895.js","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/ContractPage-7ea0aeed.css"],import.meta.url)),beforeEnter:[Do],meta:{title:"Access",darkTitle:"圆环契约",keepAlive:!0}}]},{path:"/great-old-one",component:xe,redirect:"/great-old-one/index",beforeEnter:[Eo],children:[{path:"/great-old-one/index",component:()=>T(E(()=>import("./GOOIndexPage-4af1f7f4.js"),["https://kooritea.moe/assets/GOOIndexPage-4af1f7f4.js","https://kooritea.moe/assets/PageHeader-6f1231f6.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/PageHeader-a8df6e84.css","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/GOOIndexPage-46ae5c34.css"],import.meta.url)),meta:{title:"后台管理",darkTitle:"旧日支配者的花园"}},{path:"/great-old-one/chaos",component:()=>T(E(()=>import("./GOOChaosPage-f4dae53d.js"),["https://kooritea.moe/assets/GOOChaosPage-f4dae53d.js","https://kooritea.moe/assets/PageHeader-6f1231f6.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/PageHeader-a8df6e84.css","https://kooritea.moe/assets/MDEditor-08dc63d2.js","https://kooritea.moe/assets/MarkDown-f9475c2b.js","https://kooritea.moe/assets/ImageCon-da2e8f46.js","https://kooritea.moe/assets/ImageCon-7200ecbe.css","https://kooritea.moe/assets/MarkDown-3376e058.css","https://kooritea.moe/assets/GreatOldOne-43906895.js","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/MDEditor-a98df24b.css","https://kooritea.moe/assets/GOOChaosPage-1f643076.css"],import.meta.url)),meta:{title:"编写随笔",darkTitle:"创造混沌"}},{path:"/great-old-one/revelation",component:()=>T(E(()=>import("./GOORevelationPage-1a410b17.js"),["https://kooritea.moe/assets/GOORevelationPage-1a410b17.js","https://kooritea.moe/assets/PageHeader-6f1231f6.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/PageHeader-a8df6e84.css","https://kooritea.moe/assets/GreatOldOne-43906895.js","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/GOORevelationPage-cf59e26a.css"],import.meta.url)),meta:{title:"浏览日志",darkTitle:"启示录"}},{path:"/great-old-one/mabinogion",component:()=>T(E(()=>import("./GOOMabinogionPage-a1cdc4cb.js"),["https://kooritea.moe/assets/GOOMabinogionPage-a1cdc4cb.js","https://kooritea.moe/assets/PageHeader-6f1231f6.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/PageHeader-a8df6e84.css","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/GreatOldOne-43906895.js","https://kooritea.moe/assets/GOOMabinogionPage-5cee47fd.css"],import.meta.url)),meta:{title:"处理待办",darkTitle:"黑暗圣典"}},{path:"/great-old-one/deathnote",component:()=>T(E(()=>import("./GOODeathNotePage-b78c7a5a.js"),["https://kooritea.moe/assets/GOODeathNotePage-b78c7a5a.js","https://kooritea.moe/assets/PageHeader-6f1231f6.js","https://kooritea.moe/assets/vendor-dfc99adc.js","https://kooritea.moe/assets/highlightjs-b0208cd2.js","https://kooritea.moe/assets/highlightjs-5f5db245.css","https://kooritea.moe/assets/PageHeader-a8df6e84.css","https://kooritea.moe/assets/element-plus-addd02c2.js","https://kooritea.moe/assets/element-plus-92631234.css","https://kooritea.moe/assets/GreatOldOne-43906895.js","https://kooritea.moe/assets/GOODeathNotePage-189514a1.css"],import.meta.url)),meta:{title:"文件管理",darkTitle:"死亡笔记"}}]},{path:"/:pathMatch(.*)*",redirect:"/"}],ve=Fe({history:We(),routes:To});ve.beforeEach((e,t)=>{w.commit("AppInfo/setValue",{routeLoading:e.fullPath})});ve.afterEach((e,t)=>{w.state.AppInfo.routeLoading===e.fullPath&&w.commit("AppInfo/setValue",{routeLoading:null})});const Co={components:{AsyncButtom:Be},props:{handlers:{type:Array,default:()=>[]}},setup(e,{emit:t}){const{computedHandlers:n}=ne(e,t);return{computedHandlers:g(()=>n.value.map(o=>mt(o,["handler"])).filter(o=>o.show!==!1).sort((o,s)=>o.sort-s.sort))}}},Ao={class:"button-box"};function Bo(e,t,n,o,s,r){const a=v("AsyncButtom");return c(),f("div",Ao,[(c(!0),f(W,null,te(o.computedHandlers,i=>(c(),_(a,{key:i.name,type:i.type,"on-click":i.handler,confirm:i.confirm,disabled:i.disabled},{default:B(()=>[R(O(i.name),1)]),_:2},1032,["type","on-click","confirm","disabled"]))),128))])}const Vo=M(Co,[["render",Bo],["__scopeId","data-v-a05d0297"]]);function J(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Po(e=()=>{}){const t=y(0),n=y(0),o=y(null),s=y(null),r=y(""),a={start:!1,startCoordinate:{x:0,y:0},prevCoordinate:{x:0,y:0},endCoordinate:{x:0,y:0},touches:null,isScale:!1};return{offsetX:t,offsetY:n,imageWidth:o,imageHeight:s,mainBorder:r,touchstart:u=>{u.preventDefault(),a.start=!0,u.touches.length===1?(a.startCoordinate={x:u.touches[0].clientX,y:u.touches[0].clientY},a.prevCoordinate={x:u.touches[0].clientX,y:u.touches[0].clientY}):a.touches=u.touches},touchmove:u=>{if(u.preventDefault(),a.start){if(u.touches.length>1){a.isScale=!0;let m=a.touches[0],x=a.touches[1];const se=J({x:m.clientX,y:m.clientY},{x:x.clientX,y:x.clientY});m=u.touches[0],x=u.touches[1];const Y=J({x:m.clientX,y:m.clientY},{x:x.clientX,y:x.clientY}),$=(se-Y)/10;r.value==="height"?s.value-$>50&&(s.value=s.value-$):o.value-$>50&&(o.value=o.value-$)}else if(!a.isScale){const m={x:u.touches[0].clientX,y:u.touches[0].clientY};t.value+=a.prevCoordinate.x-m.x,n.value+=a.prevCoordinate.y-m.y,a.prevCoordinate=m}}},touchend:u=>{u.preventDefault(),u.touches.length===0&&(a.isScale?a.isScale=!1:(a.start=!1,a.endCoordinate={x:u.changedTouches[0].clientX,y:u.changedTouches[0].clientY},J(a.startCoordinate,a.endCoordinate)<5&&e()))},mousedown:u=>{u.preventDefault(),a.start=!0,a.startCoordinate={x:u.clientX,y:u.clientY},a.prevCoordinate={x:u.clientX,y:u.clientY}},mousemove:u=>{if(u.preventDefault(),a.start){const m={x:u.clientX,y:u.clientY};t.value+=a.prevCoordinate.x-m.x,n.value+=a.prevCoordinate.y-m.y,a.prevCoordinate=m}},mouseup:u=>{u.preventDefault(),a.start&&(a.start=!1,a.endCoordinate={x:u.clientX,y:u.clientY},J(a.startCoordinate,a.endCoordinate)<5&&e())}}}const Go={components:{LoadingIcon:j,ButtonBox:Vo},setup(){const e=y(!1),t=y(!1),n=y(""),o=Ee([]),s=()=>{e.value=!1,t.value=!1,i.value=null,d.value=null,r.value=0,a.value=0,p.value="",n.value=""},{offsetX:r,offsetY:a,imageWidth:i,imageHeight:d,mainBorder:p,touchstart:b,touchmove:L,touchend:A,mousedown:u,mousemove:m,mouseup:x}=Po(s);return{visible:e,loading:t,src:n,handlers:o,offsetX:r,offsetY:a,imageWidth:i,imageHeight:d,mainBorder:p,touchstart:b,touchmove:L,touchend:A,mousedown:u,mousemove:m,mouseup:x,callClose:s}},computed:{imageWidthString(){return this.imageWidth===null?"auto":this.imageWidth+"px"},imageHeightString(){return this.imageHeight===null?"auto":this.imageHeight+"px"}},methods:{open({src:e,handlers:t=[]}){this.loading=!0,this.visible=!0,this.src=e,this.handlers=t;let n=!1;const o=setInterval(()=>{!n&&this.$refs.img&&this.$refs.img.width&&this.$refs.img.height&&(n=!0,clearInterval(o),this.initImageSize())},100)},vw(e){return document.documentElement.clientWidth*(e/100)},vh(e){return document.documentElement.clientHeight*(e/100)},initImageSize(){const e=this.$refs.img,t=this.vw(100);if(this.vh(100)>t){const o=this.vh(80);e.width/e.height*o>this.vw(80)?(this.imageWidth=this.vw(80),this.mainBorder="width"):(this.imageHeight=o,this.mainBorder="height")}else{const o=this.vw(80);e.height/e.width*o>this.vh(80)?(this.imageHeight=this.vh(80),this.mainBorder="height"):(this.imageWidth=o,this.mainBorder="width")}},onLoad(e){this.loading=!1},onWheel(e){e.preventDefault(),this.loading||(this.mainBorder==="height"?this.imageHeight-e.deltaY>50&&(this.imageHeight=this.imageHeight-e.deltaY):this.imageWidth-e.deltaY>50&&(this.imageWidth=this.imageWidth-e.deltaY))}}},$o=["src"];function Ho(e,t,n,o,s,r){const a=v("LoadingIcon"),i=v("ButtonBox");return o.visible?(c(),f("div",{key:0,class:"image-viewer",onWheel:t[7]||(t[7]=C((...d)=>r.onWheel&&r.onWheel(...d),["prevent","stop"])),onTouchstart:t[8]||(t[8]=(...d)=>o.touchstart&&o.touchstart(...d)),onTouchmove:t[9]||(t[9]=(...d)=>o.touchmove&&o.touchmove(...d)),onTouchend:t[10]||(t[10]=(...d)=>o.touchend&&o.touchend(...d)),onMousedown:t[11]||(t[11]=(...d)=>o.mousedown&&o.mousedown(...d)),onMousemove:t[12]||(t[12]=(...d)=>o.mousemove&&o.mousemove(...d)),onMouseup:t[13]||(t[13]=(...d)=>o.mouseup&&o.mouseup(...d))},[l("div",{class:S(["img-bg",{loading:o.loading}]),style:V({left:`calc(50% - ${o.offsetX}px)`,top:`calc(50% - ${o.offsetY}px)`})},[U(l("img",{ref:"img",class:"image",style:V({height:r.imageHeightString,width:r.imageWidthString}),src:o.src,onLoad:t[0]||(t[0]=(...d)=>r.onLoad&&r.onLoad(...d))},null,44,$o),[[je,o.imageWidth||o.imageHeight]])],6),o.loading?(c(),_(a,{key:0,class:"loading"})):h("",!0),o.handlers.length>0?(c(),_(i,{key:1,handlers:o.handlers,onTouchstart:t[1]||(t[1]=C(()=>{},["stop"])),onTouchmove:t[2]||(t[2]=C(()=>{},["stop"])),onTouchend:t[3]||(t[3]=C(()=>{},["stop"])),onMousedown:t[4]||(t[4]=C(()=>{},["stop"])),onMousemove:t[5]||(t[5]=C(()=>{},["stop"])),onMouseup:t[6]||(t[6]=C(()=>{},["stop"]))},null,8,["handlers"])):h("",!0)],32)):h("",!0)}const Ko=M(Go,[["render",Ho],["__scopeId","data-v-87672dcd"]]);let Q=null;const $e=(e,t={})=>(Q||(Q=ue(Ko).mount("#image-viewer")),Q.open({src:e,...t}),Q),No={install:(e,t)=>{e.config.globalProperties.$imagePreview=$e}},an=$e;const Ro={setup(){const{darkMode:e,mobileMode:t}=fe(),{accessKey:n,isExpiredGreatOldOne:o,offlineMode:s}=Ge(),r=()=>{t.value=window.innerWidth<window.innerHeight};F(e,i=>{i?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")}),F(t,i=>{i?document.body.classList.add("mobile-mode"):document.body.classList.remove("mobile-mode")}),Ie(()=>{window.addEventListener("resize",r),r();const i=new Date().getHours();i>=0&&i<6&&(e.value=!0,I.warning("现在是网抑时间"))}),De(()=>{window.removeEventListener("resize",r)}),s.value&&I.warning("已设置使用离线模式");const a=new Date;if(a.getHours()>=17&&a.getHours()<19&&I.warning("逢魔之时"),o.value){window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config","UA-162778519-1");const i=document.createElement("script");i.type="text/javascript",i.src="https://www.googletagmanager.com/gtag/js?id=UA-162778519-1",document.head.appendChild(i)}window.__toAuthAssetsUrl=function(i){return`${i}?token=${n.value}`}}},Uo={class:"app"};function Fo(e,t,n,o,s,r){const a=v("router-view");return c(),f("div",Uo,[k(a,null,{default:B(({Component:i})=>[e.$route.meta.keepAlive?(c(),_(Te,{key:0},[(c(),_(oe(i)))],1024)):h("",!0),e.$route.meta.keepAlive?h("",!0):(c(),_(oe(i),{key:1}))]),_:1})])}const Wo=M(Ro,[["render",Fo]]),N=ue(Wo);N.use(ve);N.use(w);N.use(No);N.use(eo);N.use(nt);N.mount("#app");export{Be as A,Vo as B,an as I,j as L,I as M,pe as S,vt as T,M as _,ne as a,Ge as b,on as c,Zo as d,xt as e,Jo as f,en as g,tn as h,E as i,bt as j,nn as k,st as l,Lt as m,ge as n,sn as o,le as p,K as q,Ce as r,Ve as s,fe as u,Qo as w};
