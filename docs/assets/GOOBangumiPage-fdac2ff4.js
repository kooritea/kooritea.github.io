import{P as x}from"./PageHeader-0eed0aeb.js";import{N as B}from"./NextButton-1d2a1405.js";import{j as C}from"./element-plus-f8e054a6.js";import{_ as k,T as N,A as I,G as M,H as V,I as A,J as P}from"./index-15846c57.js";import{I as W}from"./ImageCon-cf903686.js";import{b8 as h,bI as w,cg as d,aR as m,aS as p,bD as i,aT as s,a_ as T,b_ as D,bw as K,bA as L,bC as c,bx as Y,bB as H}from"./vendor-cce75f21.js";import"./highlightjs-4914df6f.js";const O={components:{ImageCon:W,NextButton:B,PageHeader:x,TextInput:N,ElDatePicker:C,AsyncButtom:I},setup(){const l=h(""),n=h(""),a=w([]),e=h(!0),r=h(!1),_=()=>{if(n.value)return r.value=!0,A(n.value,a.length?a.length+1:0).then(o=>{a.push(...o),e.value=o.length===24}).finally(()=>{r.value=!1})},u=()=>{if(l.value)return r.value=!0,P(l.value,a.length/24+1).then(o=>{a.push(...o),e.value=o.length===24}).finally(()=>{r.value=!1})};return{yearMonth:l,keyWord:n,onKeyWordChange:o=>{l.value="",a.splice(0,a.length),e.value=!0,_()},onMonthChange:o=>{n.value="",e.value=!0,a.splice(0,a.length),u()},listData:a,hasNext:e,switchBangumiAdded:o=>o.id?M(o.id).then(()=>{o.id=null}):(delete o.id,V(o).then(t=>{o.id=t.id})),loading:r,onNext:()=>{if(n.value)return _();if(l.value)return u()}}}},U={class:"page"},G={class:"search-box"},R={class:"bangumi-list"},b={class:"left"},j={class:"info"},E={class:"name"},S={class:"nname"},F={class:"episode-time"},J={class:"right"};function q(l,n,a,e,r,_){const u=d("PageHeader"),g=d("el-date-picker"),v=d("TextInput"),y=d("ImageCon"),f=d("AsyncButtom"),o=d("NextButton");return m(),p("div",U,[i(u),s("div",G,[i(g,{modelValue:e.yearMonth,"onUpdate:modelValue":n[0]||(n[0]=t=>e.yearMonth=t),type:"month",placeholder:"按月份搜索","value-format":"YYYY-M",onChange:e.onMonthChange},null,8,["modelValue","onChange"]),i(v,{modelValue:e.keyWord,"onUpdate:modelValue":n[1]||(n[1]=t=>e.keyWord=t),"on-input":e.onKeyWordChange},null,8,["modelValue","on-input"])]),s("div",R,[(m(!0),p(T,null,D(e.listData,t=>(m(),p("div",{key:t.subject,class:"bangumi"},[s("div",b,[i(y,{src:t.img,prefix:["https://lain.bgm.tv/pic/cover/c"],onClick:z=>l.$imagePreview(`https://lain.bgm.tv/pic/cover/l${t.img}`)},null,8,["src","prefix","onClick"]),s("div",j,[s("div",E,c(t.name),1),s("div",S,c(t.nname),1),s("div",F,c(t.episode?`${t.episode}集`:"")+" "+c(t.time),1)])]),s("div",J,[i(f,{type:t.id?"primary":"default",onLoadingClick:()=>e.switchBangumiAdded(t)},{default:Y(()=>[H(c(t.id?"已添加":"添加"),1)]),_:2},1032,["type","onLoadingClick"])])]))),128))]),e.keyWord||e.yearMonth?(m(),K(o,{key:0,hasNext:e.hasNext,"onUpdate:hasNext":n[2]||(n[2]=t=>e.hasNext=t),loading:e.loading,"onUpdate:loading":n[3]||(n[3]=t=>e.loading=t),onLoadingClick:e.onNext},null,8,["hasNext","loading","onLoadingClick"])):L("",!0)])}const ne=k(O,[["render",q],["__scopeId","data-v-39b7d682"]]);export{ne as default};
