import{P}from"./PageHeader-a0452138.js";import{_ as k,u as I,j as E,f as x}from"./index-b2eba1b7.js";import{u as z,i as H,a as L,b as B,c as S,d as V,e as G,f as v}from"./echarts-a65e1005.js";import{aU as m,aY as N,b0 as T,aX as g,aL as _,aM as A,bl as C,bi as $,cd as b,br as w,bo as U,bu as X}from"./vendor-c051abc1.js";import{n as Y}from"./GreatOldOne-9001da38.js";import"./element-plus-8a9e1d14.js";import"./highlightjs-4914df6f.js";z([H,L,B,S,V,G]);const q={props:{option:{type:Object,default:()=>({})}},setup(p,{emit:l}){const s=m(!0),{darkMode:e}=I(),{computedOption:n}=E(p,l),o=m(null);let t;const r=()=>{t&&n.value&&t.resize()};return N(()=>{t=v(o.value,e.value?"dark":void 0),n.value&&t.setOption(n.value),window.addEventListener("resize",r)}),T(()=>{window.removeEventListener("resize",r)}),g(n,()=>{t&&n.value&&t.setOption(n.value)}),g(e,()=>{s.value=!1,$(()=>{s.value=!0,$(()=>{t=v(o.value,e.value?"dark":void 0),t.setOption(n.value)})})}),{echars:o,refreshCache:s}}},K={key:0,ref:"echars",style:{height:"500px"}};function j(p,l,s,e,n,o){return e.refreshCache?(_(),A("div",K,null,512)):C("",!0)}const F=k(q,[["render",j]]);const J={components:{PageHeader:P,EChars:F},setup(){const p=c=>{let a="";for(const i in c)a?c[i]>c[a]&&(a=i):a=i;return a},l=new Date;l.setHours(0,0,0,0);const s=new Array(7).fill(null).map((c,a)=>{const i=new Date(l.valueOf()-a*1e3*60*60*24);return x(i,"yyyy-MM-dd")}).reverse(),e=[],n=m(null),o=[],t=[],r=m(null);return Y().then(c=>{for(const{uuid:a,accessInfo:i,tagCount:O}of c){o.push(p(O));for(const{date:D,requestInfo:d}of i){const M=new Date(D),f=s.findIndex(y=>x(M,"yyyy-MM-dd")===y);e[f]||(e[f]=[]),e[f].includes(a)||e[f].push(a);const h=o.length-1;let u=t.find(y=>y.name===`${d.method} ${d.url}`);u||(u={name:`${d.method} ${d.url}`,type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:[]},t.push(u)),u.data[h]||(u.data[h]=0),u.data[h]++}}n.value={title:{text:"独立访客人数"},tooltip:{confine:!0},xAxis:{data:s},yAxis:{},series:[{name:"人数",type:"bar",data:e.map(a=>a.length)}]},r.value={title:{text:"各访客访问情况"},tooltip:{trigger:"axis",confine:!0,axisPointer:{type:"shadow"},extraCssText:"width:300px;white-space: break-spaces;"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:o,axisLabel:{formatter:function(a,i){return a.slice(0,6)}}},series:t}}),{option1:n,option2:r}}},Q={class:"page"};function R(p,l,s,e,n,o){const t=b("PageHeader"),r=b("EChars");return _(),A("div",Q,[w(t),w(r,{option:e.option1,style:{height:"500px"}},null,8,["option"]),e.option2?(_(),U(r,{key:0,option:e.option2,style:X({height:`${e.option2.yAxis.data.length*50+100}px`})},null,8,["option","style"])):C("",!0)])}const se=k(J,[["render",R],["__scopeId","data-v-c0b3580a"]]);export{se as default};
