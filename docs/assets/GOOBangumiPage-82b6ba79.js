import{P as x}from"./PageHeader-1434f07e.js";import{N as B}from"./NextButton-cb5f21c5.js";import{i as k}from"./element-plus-5ffd9a32.js";import{_ as N,T as C,A as M}from"./index-cebb2139.js";import{I as V}from"./ImageCon-fb2e59d6.js";import{h as P,i as I,s as W,j as A}from"./GreatOldOne-277dd63c.js";import{aU as u,bx as w,cd as i,aL as h,aM as _,br as d,aN as s,bm as K,bP as T,bo as U,bl as Y,bt as c,bp as D,bQ as O}from"./vendor-128acd8f.js";import"./highlightjs-b0208cd2.js";const H={components:{ImageCon:V,NextButton:B,PageHeader:x,TextInput:C,ElDatePicker:k,AsyncButtom:M},setup(){const l=u(""),n=u(""),a=w([]),e=u(!0),r=u(!1),p=()=>{if(n.value)return r.value=!0,W(n.value,a.length?a.length+1:0).then(o=>{a.push(...o),e.value=o.length===24}).finally(()=>{r.value=!1})},m=()=>{if(l.value)return r.value=!0,A(l.value,a.length/24+1).then(o=>{a.push(...o),e.value=o.length===24}).finally(()=>{r.value=!1})};return{yearMonth:l,keyWord:n,onKeyWordChange:o=>{l.value="",a.splice(0,a.length),e.value=!0,p()},onMonthChange:o=>{n.value="",e.value=!0,a.splice(0,a.length),m()},listData:a,hasNext:e,switchBangumiAdded:o=>o.id?P(o.id).then(()=>{o.id=null}):(delete o.id,I(o).then(t=>{o.id=t.id})),loading:r,onNext:()=>{if(n.value)return p();if(l.value)return m()}}}},j={class:"page"},E={class:"search-box"},G={class:"bangumi-list"},L={class:"left"},R={class:"info"},F={class:"name"},Q={class:"nname"},S={class:"episode-time"},b={class:"right"};function q(l,n,a,e,r,p){const m=i("PageHeader"),v=i("el-date-picker"),g=i("TextInput"),f=i("ImageCon"),y=i("AsyncButtom"),o=i("NextButton");return h(),_("div",j,[d(m),s("div",E,[d(v,{modelValue:e.yearMonth,"onUpdate:modelValue":n[0]||(n[0]=t=>e.yearMonth=t),type:"month",placeholder:"按月份搜索","value-format":"YYYY-M",onChange:e.onMonthChange},null,8,["modelValue","onChange"]),d(g,{modelValue:e.keyWord,"onUpdate:modelValue":n[1]||(n[1]=t=>e.keyWord=t),"on-input":e.onKeyWordChange},null,8,["modelValue","on-input"])]),s("div",G,[(h(!0),_(K,null,T(e.listData,t=>(h(),_("div",{key:t.subject,class:"bangumi"},[s("div",L,[d(f,{src:t.img,prefix:["https://lain.bgm.tv/pic/cover/c"],onClick:z=>l.$imagePreview(`https://lain.bgm.tv/pic/cover/l${t.img}`)},null,8,["src","prefix","onClick"]),s("div",R,[s("div",F,c(t.name),1),s("div",Q,c(t.nname),1),s("div",S,c(t.episode?`${t.episode}集`:"")+" "+c(t.time),1)])]),s("div",b,[d(y,{type:t.id?"primary":"default","on-click":()=>e.switchBangumiAdded(t)},{default:D(()=>[O(c(t.id?"已添加":"添加"),1)]),_:2},1032,["type","on-click"])])]))),128))]),e.keyWord||e.yearMonth?(h(),U(o,{key:0,hasNext:e.hasNext,"onUpdate:hasNext":n[2]||(n[2]=t=>e.hasNext=t),loading:e.loading,"onUpdate:loading":n[3]||(n[3]=t=>e.loading=t),"on-click":e.onNext},null,8,["hasNext","loading","on-click"])):Y("",!0)])}const ae=N(H,[["render",q],["__scopeId","data-v-2fa295d8"]]);export{ae as default};
