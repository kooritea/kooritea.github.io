{"id":2075,"content":"换了miui的权限管理器之后，如果不给自启动的权限的话就完全拉不起来了，xp+root绿色守护加持的fcm也不行。\n\n在miui权限管理器看来xp+root绿色守护加持的fcm拉起应用属于应用的自启动而不是被别人拉起(应用行为记录可以看到chrome自启动被拒绝了)。而原生的权限管理器没有管这个，任何应用都能被xp+root绿色守护加持的fcm叫起来，所以原生的时候知乎用fcm倒垃圾的话虽然系统能阻止他发通知但不能阻止他在后台启动(这个是绿色守护的功能不完善，不能控制fcm可以拉起哪些应用)，最后再被绿色守护杀掉。\n\nfcm是首先拉起chrome，如果这时候chrome自启动被拒绝那这条消息就没了。\n如果chrome自启动成功，就会尝试把消息传递给pwa，如果pwa有自启动权限，就正常拉起pwa处理通知，然后通知栏会显示pwa发送的通知。\n如果pwa没有自启动权限被拒绝启动，chrome就会自己跑pwa的server-worker然后处理通知，最后通知栏会显示chrome发送的通知。\n\n只给pwa自启动不给chrome的话fcm是不能拉起pwa的。\n\n没有自启动权限的应用在任务管理器划掉后是不能驻后台的直接会被完全杀掉，这和原生的权限管理系统不一样，原生的是有没有自启动都可以驻后台的，不过实际上驻不驻后台看app自己的实现，像termux就会留在后台保持上下文，微信就会完全挂掉。最后会在熄屏后被绿色守护杀掉。","hide":"","time":"2020-05-15T09:43:41.000Z"}