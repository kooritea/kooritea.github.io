{"id":2579,"content":"fcm 又开始出现无法重连的情况\n本来以为是换了权限管理器的问题，但是发现把权限管理器换回去也还是会这样，没办法，另找办法\n![caff2fbd5a6dae925d9a903e3b274c94](/2020/09/10/caff2fbd5a6dae925d9a903e3b274c94.png)\n发现在play商店上下载的`Heartbeat Fixer for GCM`，一打开服务fcm的重连时间就会变成正常的倒数然后重连（虽然这次重连失败之后依然会变成无法重连的负数），不过这里有了一个关键信息是无root无xposed可以让fcm重连，那只要我想办法知道fcm Reconnection Manager 出问题然后像他一样让fcm重连就好了\n\n先反编译看看它是怎么样让fcm重连的\n定位到`io/github/mobodev/heartbeatfixerforgcm/HeartbeatReceiver`，发现是它打开服务的时候发了两个广播\n这个好办，用am模仿它发两个广播\n\n```bash\nsu\nam broadcast -a com.google.android.intent.action.GTALK_HEARTBEAT\nam broadcast -a com.google.android.intent.action.MCS_HEARTBEAT\n```\n\n结果还真是这个两个广播可以触发fcm重连(事实上使用网络环境切换的广播应该也是可以的，但不可能只为了fcm就疯狂发这个广播，因为会有很多app都响应)\n\n接下来只剩下如何检测fcm会出现这个问题就好了，因为可以用xposed这个应该不难吧","hide":"","time":"2020-09-10T07:13:53.000Z"}