{"id":2111,"content":"经过数不清的重启终于把短信的智能分类和验证码快捷复制搞回来了\n```bash\nupdate_international_build_flag \"$apkdir/smali/com/android/mms\"\nupdate_international_build_flag \"$apkdir/smali/com/miui/smsextra\"\n$patchmethod $apkdir/smali/com/android/mms/util/UriUtils.smali -isGlobalSms\n$patchmethod $apkdir/smali/com/xiaomi/channel/commonutils/android/MIUIUtils.smali -isGlobalRegion\n$patchmethod $apkdir/smali/com/xiaomi/channel/commonutils/android/SystemUtils.smali -isGlobalVersion\n$patchmethod $apkdir/smali/com/android/mms/storage/StorageManager.smali isVerificationCodeCategoryEnabled\n$patchmethod $apkdir/smali/com/android/mms/util/VerificationCodeUtils.smali isVerificationCodeCategoryEnabled\n$patchmethod $apkdir/smali/com/miui/smsextra/util/UpdateVerificationCodeUtils.smali isVerificationCodeCategoryEnabled\n```\n\ncom.android.mms 所有的IS_INTERNATIONAL_BUILD替换成false ，效果是会出现通知类消息聚合\ncom.miui.smsextra所有的IS_INTERNATIONAL_BUILD替换成false，效果是会有头顶的普通短信和推广短信的智能分类\n\n下面6个方法的修改才会出现验证码聚合和快捷复制验证码\n\n这里实际上还有一个IS_GLOBAL_BUILD的常量\n但是凄凉替换这个会卡米，所以只好改关键方法","hide":"","time":"2020-05-21T14:40:41.000Z"}